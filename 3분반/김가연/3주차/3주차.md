# Chapter 1-17 ~ 1-22
## 📑 컴포넌트 이벤트 만들기

```
// App.js 코드 -> onChangePage()와 props, state 통해서 클릭 이벤트 발생시 mode 변경

import React, { Component } from "react";
import "./App.css";
import TOC from "./Component/TOC";
import Content from "./Component/Content";
import Subject from "./Component/Subject";

class App extends Component {
  constructor(props) {
    super(props);
    this.state = {
      mode: "read",
      subject: { title: "WEB", sub: "World Wide Web!!" },
      welcome: { title: "Welcome", sub: "Hello, React!" },
      contents: [
        { id: 1, title: "HTML", desc: "HTML is for information" },
        { id: 2, title: "CSS", decs: "CSS is for design" },
        { id: 3, title: "JavaScript", decs: "JavaScript if for interactive" },
      ],
    };
  }

  render() {
    console.log("App reader"); // render 함수 호출 순서를 알아보기 위한 함수.
    var _title,
      _desc = null;

    if (this.state.mode === "welcome") {
      {
        /* state의 mode 값이 'welcome'일 때*/
      }
      _title = this.state.welcome.title; // _title 값을 this.state.title로 지정
      _desc = this.state.welcome.decs; // _desc의 값을 this.state.welcome.desc로 각각 지정
    } else if (this.state.mode === "read") {
      {
        /* state의 mode 값이 'read'일 때는 */
      }
      _title = this.state.contents[0].title; //_title 값을 this.state.contents[0].title로 지정
      _desc = this.state.contents[0].decs; //_desc 값을 this.state.contents[0].desc로 지정
    }

    console.log("render", this); // 컴포넌트 자기 자신을 가리키는 this 출력

    return (
      <div className="App">
        
        <Subject
          title={this.state.subject.title}
          sub={this.state.subject.sub}
          onChangePage={function(){
            this.setState({mode: 'welcome'}); // onChangePage 함수에서 state값 변경하기
          }.bind(this)}>
          </Subject>

        <TOC //list 항목들 누르면 'hi'라는 알람창 뜨게 만들기
        onChangePage={function() {
          this.setState({mode: 'read'}); // onChangePage 함수에서 state값 변경하기
        }.bind(this)} 
        data={this.state.contents}></TOC>

        <Content title={this.state.subject.title} desc={_desc}></Content>
      </div>
    );
  }
}

export default App;

```
```
// Subject.js 코드
class Subject extends Component {
  render() {
    return (
      <header>
          <h1>
            <a
              href="/"
              onClick={function (e) {
                e.preventDefault();
                this.props.onChangePage();
              }.bind(this)}>{this.props.title}
            </a>
          </h1>
          {this.props.sub}
        </header>
    )}
  }
```
```
// TOC.js 코드

import React, { Component } from "react";
class TOC extends Component {
    render() {
      console.log('TOC render');
      
      var lists= [];
      var data = this.props.data;
      var i = 0;

      while(i < data.length) {
        lists.push(
        <li key={data[i].id}>
          <a href={"/contents/"+data[i].id}
          onClick={function(e) { // a 태그 안에서 발생하는 onClick 이벤트 정의
            e.preventDefault(); // 이벤트 실행시 페이지가 변경되지 않도록 preventDefault 함수 실행
            this.props.onChangePage();
          }.bind(this)}
          >{data[i].title}</a></li>);
        i = i + 1
      }
      return(
        <nav>
            <ul>
                {lists}
            </ul>
        </nav>
      );
    }
  }

export default TOC;
```
### ▶️id 값 지정
```
//main.js 코드

class App extends Component {
  constructor(props) {
    super(props);
    this.state = {
      mode: "read",
      selected_content_id: 2, //현재 활성화된 (선택된) 콘텐츠가 표시되게 만들기위해 추가된 state 속성 / 초깃값 2 이므로 this.contents의 두 번째 값, CSS가 해당된다.
      subject: { title: "WEB", sub: "World Wide Web!!" },
      welcome: { title: "Welcome", sub: "Hello, React!" },
      contents: [
        { id: 1, title: "HTML", desc: "HTML is for information" },
        { id: 2, title: "CSS", decs: "CSS is for design" },
        { id: 3, title: "JavaScript", decs: "JavaScript if for interactive" },
      ],
    };
  }
~생략~
} else if (this.state.mode === "read") {
      {
        var i = 0;
        while(i < this.state.contents.length) {
          var data = this.state.contents[i];
          if (data.id === this.state.selected_content_id) { // data.id 값과 this.state.selected_content_id 값이 일치하는 것이 발견되면
            _title = data.title; // _title 값과
            _desc = data.decs; // _desc 값은 TOC 컴포넌트의 props로 넘어감.
            break;
          }
          i = i + 1;
        }
      }
    }
```
```
// TOC.js 코드
// onChangePage 함수를 호출할때 클릭한 항목의 id 값을 인자로 전달

while(i < data.length) {
        lists.push(
        <li key={data[i].id}>
          <a href={"/contents/"+data[i].id}
          data-id = {data[i].id} //data-id 속성 추가, id 값 할당
          onClick={function(e) { // a 태그 안에서 발생하는 onClick 이벤트 정의
            e.preventDefault(); // 이벤트 실행시 페이지가 변경되지 않도록 preventDefault 함수 실행
            this.props.onChangePage(e.target.dataset.id); //onClick 함수의 인자로 전달된 e 객체를 활용해 id 값을 구해 onChangePage 함수 호출
            this.props.onChangePage();
          }.bind(this)}
          >{data[i].title}</a></li>);
        i = i + 1
      }
```

  * 이벤트 객체 내의 target 속성: 이벤트가 발생한 태그, 즉 여기서는 `<a>`태그에 지정해둔 data-id에 접근할 수 있게 되는것.

## 📑 중간 개념 정리
  * 컴포넌트 안에서 외부에서 전달된 props 값을 바꾸는 것 금지되어 있음. (props는 읽기 전용)
  * 컴포넌트는 props와 state 영향에 따라 어떤 상태가 될 텐데, 그 상태가 실제 웹 브라우저의 HTML(DOM)이라고 하는것에 영향을 줘서 UI가 그려진다.
  * 상위컴포넌트 -> 하위컴포넌트로 값 전달하는경우: props 통해 전달 / 하위컴포넌트 -> 상위컴포넌트로 값 전달하는 경우: 이벤트를 사용.
  * Redux 개념 간단 정리: 데이터를 각 컴포넌트에 분산해서 보관하는 것이 아니라 하나의 데이터 저장소가 있어서 데이터 저장소의 값이 바뀌면해당 값과 관련된 모든 컴포넌트가 알아서 바뀌게 하는 기법

## 📑 Create 구현
### ▶️ 모드 변경 기능
: Creat, Update, delete 링크/버튼을 만드는 컴포넌트 작성, 컴포넌트 이벤트 추가 -> create, update, delete를 클릭할 때 App 컴포넌트의 state mode 값이 변경됨
```
//App.js 코드

class App extends Component {
  constructor(props) {
    super(props);
    this.state = {
      mode: "read",
      selected_content_id: 1, // 기본값을 1로 설정
      subject: { title: "WEB", sub: "World Wide Web!!" },
      welcome: { title: "Welcome", sub: "Hello, React!" },
      contents: [
        { id: 1, title: "HTML", desc: "HTML is for information" },
        { id: 2, title: "CSS", desc: "CSS is for design" },
        { id: 3, title: "JavaScript", desc: "JavaScript is for interactive" },
      ],
    };
  }

  render() {
    console.log("App render");

    var _title,
      _desc = null;

    if (this.state.mode === "welcome") {
      // state의 mode 값이 'welcome'일 때
      _title = this.state.welcome.title;
      _desc = this.state.welcome.sub; // _desc의 값을 this.state.welcome.sub로 지정
    } else if (this.state.mode === "read") {
      // state의 mode 값이 'read'일 때
      var i = 0;
      while (i < this.state.contents.length) {
        var data = this.state.contents[i];
        if (data.id === this.state.selected_content_id) {
          _title = data.title;
          _desc = data.desc; // desc로 수정
          break;
        }
        i = i + 1;
      }
    }

    console.log("render", this);

    return (
      <div className="App">
        <Subject
          title={this.state.subject.title}
          sub={this.state.subject.sub}
          onChangePage={function () {
            this.setState({ mode: "welcome" }); // onChangePage 함수에서 state 값 변경
          }.bind(this)}
        ></Subject>
        <TOC
          onChangePage={function (id) {
            this.setState({
              mode: "read",
              selected_content_id: Number(id),
            }); // onChangePage 함수에서 state 값 변경
          }.bind(this)}
          data={this.state.contents}
        ></TOC>
        <Control
          onChangeMode={function (_mode) {
            this.setState({
              mode: _mode,
            });
          }.bind(this)} // this 바인딩 추가
        ></Control>{" "}
        {/*Control 컴포넌트 추가*/}
        <Content title={_title} desc={_desc}></Content>
      </div>
    );
  }
}

export default App;

```
```
//Control.js 코드

import React, { Component } from "react";

class Subject extends Component {
  render() {
    console.log('Control render');
    return (
      <ul>
          <li><a href="/create" onClick={function(e) { //각 리스트-a태그에 이벤트 추가해주기
            e.preventDefault();
            this.props.onChangeMode('create');
          }.bind(this)}>create</a></li>

          <li><a href="/update" onClick={function(e) {
            e.preventDefault();
            this.props.onChangeMode('update');
          }.bind(this)}>update</a></li>

          <li><input onClick={function(e){
            this.props.onChangeMode('delete');
          }.bind(this)} type="button" value="delete"></input></li>
      </ul>
    )}
  }

export default Subject;
```
### ▶️ CreateContent와 ReadContent 분리
: 기존 Content.js 파일명을 ReadContent.js로 수정 (읽기 전용 컨텐츠 이므로)

### ▶️ create 링크 클릭했을때 CreateContent 내용 보여주기
```
//App.js 코드

class App extends Component {
  constructor(props) {
    super(props);
    this.state = {
      mode: "read",
      selected_content_id: 1, // 기본값을 1로 설정
      subject: { title: "WEB", sub: "World Wide Web!!" },
      welcome: { title: "Welcome", sub: "Hello, React!" },
      contents: [
        { id: 1, title: "HTML", desc: "HTML is for information" },
        { id: 2, title: "CSS", desc: "CSS is for design" },
        { id: 3, title: "JavaScript", desc: "JavaScript is for interactive" },
      ],
    };
  }

  render() {
    console.log("App render");

    var _title,
      _desc,
      _article = null;

    if (this.state.mode === "welcome") {
      // state의 mode 값이 'welcome'일 때
      _title = this.state.welcome.title;
      _desc = this.state.welcome.sub; // _desc의 값을 this.state.welcome.sub로 지정
      _article = <ReadContent title={_title} desc={_desc}></ReadContent>;
    } else if (this.state.mode === "read") {
      // state의 mode 값이 'read'일 때
      var i = 0;
      while (i < this.state.contents.length) {
        var data = this.state.contents[i];
        if (data.id === this.state.selected_content_id) {
          _title = data.title;
          _desc = data.desc; // desc로 수정
          break;
        }
        i = i + 1;
      }
      _article = <ReadContent title={_title} desc={_desc}></ReadContent>;
    } else if (this.state.mode === "create") {
      _article = (
        <CreateContent></CreateContent>
      ); /*모드가 create일때 CreateContent를 화면에 출력*/
    }

    console.log("render", this);

    return (
      <div className="App">
        <Subject
          title={this.state.subject.title}
          sub={this.state.subject.sub}
          onChangePage={function () {
            this.setState({ mode: "welcome" }); // onChangePage 함수에서 state 값 변경
          }.bind(this)}
        ></Subject>
        <TOC
          onChangePage={function (id) {
            this.setState({
              mode: "read",
              selected_content_id: Number(id),
            }); // onChangePage 함수에서 state 값 변경
          }.bind(this)}
          data={this.state.contents}
        ></TOC>
        <Control
          onChangeMode={function (_mode) {
            this.setState({
              mode: _mode,
            });
          }.bind(this)}
        ></Control>
        {_article}
        {/*ReadContent 영역이 가변적으로 바뀔 수 있도록 _article로 처리*/}
      </div>
    );
  }
}

export default App;
```
```
// CreateContent.js 코드
import React, { Component } from "react";

class CreateContent extends Component {
  render() {
    console.log("Content render");

    return (
      <article>
        <h2>Create</h2>
        <form
          action="/create_process"
          method="post"
          onSubmit={function (e) {
            e.preventDefault();
            alert("Subit!!");
          }.bind(this)}
        >
          <p>
            <input type="text" name="title" placeholder="title"></input>
          </p>
          <textarea name="desc" placeholder="description"></textarea>
          <p>
            <input type="submit"></input>
          </p>
        </form>
      </article>
    );
  }
}

export default CreateContent;
```




